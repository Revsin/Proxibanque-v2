<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Conseiller</title>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<script>
	let myCallBack = function(reponse) {
		console.log("callback a executer a la reception d'une reponse")
		//alert(reponse.responseText);	      
		console.log("JsonParse")
		var url_string = window.location.href;
		//alert(url_string)
		var url = new URL(url_string);
		var indice_conseiller = url.searchParams.get("indice_conseiller");
		//alert(indice_conseiller)
		let elements = JSON.parse(reponse.responseText);
		let table = "<tr><th>Indice</th><th>Conseiller</th><th>Numero</th><th>Nom</th><th>Prénom</th><th>Adresse</th><th>Code Postal</th><th>Ville</th><th>Téléphone</th><th>Email</th></tr>";
		for (i = 0; i < elements.length; i++) {
			let item = elements[i];
			if(indice_conseiller === item.conseiller){
			table += "<tr><td>" + (i+1) +"</td><td>" + item.conseiller + "</td><td>" + item.numero
					+ "</td><td>" + item.nom + "</td><td>" + item.prenom
					+ "</td><td>" + item.adresse + "</td><td>"
					+ item.codePostal + "</td><td>" + item.ville + "</td><td>"
					+ item.telephone + "</td><td>" + item.email + "</td></tr>";
			}
		}
		let elementDiv = document.getElementById("divResultat");
		elementDiv.innerHTML = table;

	}

	function call() {
		console.log("Appel AJAX");
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				myCallBack(this);
			}
		}
		xhttp.open("GET", "listeClient.json", true);
		xhttp.send();
	}

	window.onload = call;
</script>
</head>
<body>

	<div id="d1">
		<h1>Espace conseiller</h1>
	</div>

	<div>

		<h1>Liste de vos Clients</h1>

	</div>

	<hr></hr>


	<table id="divResultat" class="alert alert-info table table-striped"></table>


	<div id="d2">
		
			<button class="button" style="vertical-align: middle"><span>Editer un client</span></button>
			<button class="button" style="vertical-align: middle"><span>Liste des comptes</span></button>
			<button class="button" style="vertical-align: middle"><span>Effectuer un virement</span></button>
		

	</div>

</body>
</html>





